\hypertarget{classZmpPreviewController}{}\section{Zmp\+Preview\+Controller Class Reference}
\label{classZmpPreviewController}\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}


Implementes an extended Z\+MP preview controller as an unconstrained QP problem.  




{\ttfamily \#include $<$Zmp\+Preview\+Controller.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classZmpPreviewController_ac8837fd39b0b942afd3dd5759c456b42}{Zmp\+Preview\+Controller} ()
\item 
\hyperlink{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd}{$\sim$\+Zmp\+Preview\+Controller} ()
\item 
bool \hyperlink{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd}{initialize} ()
\item 
bool \hyperlink{classZmpPreviewController_a65905572c73752a3ff46c0435c9794a0}{initialize\+Matrices} ()
\item 
bool \hyperlink{classZmpPreviewController_a378a6408072c1d7b962e8e52af30b634}{build\+C\+O\+M\+Integration\+Matrices} ()
\item 
bool \hyperlink{classZmpPreviewController_aadf1b7cba1ac0a1e6ec3bc8e0b761d02}{build\+Z\+M\+P\+Preview\+Matrices} ()
\item 
bool \hyperlink{classZmpPreviewController_aa763d1c7a769f21eeaaaeb3f09a32aef}{build\+C\+O\+M\+Vel\+Preview\+Matrices} ()
\item 
bool \hyperlink{classZmpPreviewController_a321140d8b3d99cf82687c444344c161d}{compute\+Optimal\+Input} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implementes an extended Z\+MP preview controller as an unconstrained QP problem. 

\begin{DoxyNote}{Note}
Put original Z\+MP preview control reference along with Aurelien\textquotesingle{}s
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Jorhabib Eljaik
\end{DoxyAuthor}
Given a rough Z\+MP trajectory and a corresponding consistent CoM velocity, this class computes at a fast rate optimal CoM jerks over a refined preview horizon. The Z\+MP preview control formulation in (reference goes here) is extended to account for a CoM tracking objective in order to minimize the error over a preview horizon to reference CoM velocities. This preview controller solves with

\[ \mathcal{U}_{k+N|k} = {\vec{u}_{k|k}, ... , \vec{u}} \]

Denoting a horizon of input CoM jerks \{u\}, the following problem\+:

\begin{align*} \underset{\mathcal{U}_{k+N|k}}{\text{min}} \; \sum_{j=1}^{N} & \eta_b || \mathbf{p}_{k+j|k} - \mathbf{r}_{k+j|k}^r ||^2 + \eta_w ||\mathbf{\dot{h}}_{k+j|k} - \dot{\mathbf{h}}^r_{k+j|k} ||^2 + \eta_r || \mathbf{u} ||^2 \\ \text{such that}&\\ \mathbf{p} &= \mathbf{h} - \mathbf{c}\mathbf{e}_2 \mathbf{\ddot{h}} \\ \mathbf{\hat{h}}_{k+j+1|k} &= \mathbf{A}_h \hat{\mathbf{h}}_{k+j|k} + \mathbf{B}_h \mathbf{u}_{k+j+1|k} \\ \mathbf{h}_{k+j|k} &= \mathbf{h}_k\\ \mathbf{h} &= \mathbf{c} - (\mathbf{c}\cdot\mathbf{e}_2)\mathbf{e}_2 \end{align*}

Where $\mathbf{p}$ are horizontal Z\+MP coordinates, $ \mathbf{r}^r $ Z\+MP references (in walking-\/client is the interpolated Z\+MP reference from the walking M\+I\+QP problem) $ \mathbf{\dot{h}} $ the horizontal C\+OM velocity, $ \mathbf{\dot{h}}^r $ C\+OM horizontal velocity reference (in walking-\/client it\textquotesingle{}s the interpolated C\+OM velocity reference from the walking M\+I\+QP problem). $\mathbf{u}$ are the input C\+OM jerks, $h$ the horizonal C\+OM position, $\hat{h}$ the horizontal C\+OM state $ (\mathbf{h}, \mathbf{\dot{h}}, \mathbf{\ddot{h}}) $ and $\mathbf{e}_2$ the vertical unit vectory $ [0\;0\;1]^T$. $A_h$ and $B_h$ are integration matrices. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classZmpPreviewController_ac8837fd39b0b942afd3dd5759c456b42}{}\label{classZmpPreviewController_ac8837fd39b0b942afd3dd5759c456b42} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{Zmp\+Preview\+Controller()}{ZmpPreviewController()}}
{\footnotesize\ttfamily Zmp\+Preview\+Controller\+::\+Zmp\+Preview\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd}{}\label{classZmpPreviewController_af702c45f318c7a78310d19cc061886dd} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!````~Zmp\+Preview\+Controller@{$\sim$\+Zmp\+Preview\+Controller}}
\index{````~Zmp\+Preview\+Controller@{$\sim$\+Zmp\+Preview\+Controller}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{$\sim$\+Zmp\+Preview\+Controller()}{~ZmpPreviewController()}}
{\footnotesize\ttfamily Zmp\+Preview\+Controller\+::$\sim$\+Zmp\+Preview\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



\subsection{Member Function Documentation}
\hypertarget{classZmpPreviewController_a378a6408072c1d7b962e8e52af30b634}{}\label{classZmpPreviewController_a378a6408072c1d7b962e8e52af30b634} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!build\+C\+O\+M\+Integration\+Matrices@{build\+C\+O\+M\+Integration\+Matrices}}
\index{build\+C\+O\+M\+Integration\+Matrices@{build\+C\+O\+M\+Integration\+Matrices}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{build\+C\+O\+M\+Integration\+Matrices()}{buildCOMIntegrationMatrices()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::build\+C\+O\+M\+Integration\+Matrices (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_aa763d1c7a769f21eeaaaeb3f09a32aef}{}\label{classZmpPreviewController_aa763d1c7a769f21eeaaaeb3f09a32aef} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!build\+C\+O\+M\+Vel\+Preview\+Matrices@{build\+C\+O\+M\+Vel\+Preview\+Matrices}}
\index{build\+C\+O\+M\+Vel\+Preview\+Matrices@{build\+C\+O\+M\+Vel\+Preview\+Matrices}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{build\+C\+O\+M\+Vel\+Preview\+Matrices()}{buildCOMVelPreviewMatrices()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::build\+C\+O\+M\+Vel\+Preview\+Matrices (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_aadf1b7cba1ac0a1e6ec3bc8e0b761d02}{}\label{classZmpPreviewController_aadf1b7cba1ac0a1e6ec3bc8e0b761d02} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!build\+Z\+M\+P\+Preview\+Matrices@{build\+Z\+M\+P\+Preview\+Matrices}}
\index{build\+Z\+M\+P\+Preview\+Matrices@{build\+Z\+M\+P\+Preview\+Matrices}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{build\+Z\+M\+P\+Preview\+Matrices()}{buildZMPPreviewMatrices()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::build\+Z\+M\+P\+Preview\+Matrices (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_a321140d8b3d99cf82687c444344c161d}{}\label{classZmpPreviewController_a321140d8b3d99cf82687c444344c161d} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!compute\+Optimal\+Input@{compute\+Optimal\+Input}}
\index{compute\+Optimal\+Input@{compute\+Optimal\+Input}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{compute\+Optimal\+Input()}{computeOptimalInput()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::compute\+Optimal\+Input (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd}{}\label{classZmpPreviewController_ac28287e01187bff2cea5a68292d936bd} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!initialize@{initialize}}
\index{initialize@{initialize}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{initialize()}{initialize()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::initialize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hypertarget{classZmpPreviewController_a65905572c73752a3ff46c0435c9794a0}{}\label{classZmpPreviewController_a65905572c73752a3ff46c0435c9794a0} 
\index{Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}!initialize\+Matrices@{initialize\+Matrices}}
\index{initialize\+Matrices@{initialize\+Matrices}!Zmp\+Preview\+Controller@{Zmp\+Preview\+Controller}}
\subsubsection{\texorpdfstring{initialize\+Matrices()}{initializeMatrices()}}
{\footnotesize\ttfamily bool Zmp\+Preview\+Controller\+::initialize\+Matrices (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/jorhabibeljaik/\+Code/codyco-\/superbuild/main/ocra-\/wbi-\/plugins/ocra-\/icub-\/clients/walking-\/client/include/walking-\/client/\hyperlink{ZmpPreviewController_8h}{Zmp\+Preview\+Controller.\+h}\item 
/\+Users/jorhabibeljaik/\+Code/codyco-\/superbuild/main/ocra-\/wbi-\/plugins/ocra-\/icub-\/clients/walking-\/client/src/\hyperlink{ZmpPreviewController_8cpp}{Zmp\+Preview\+Controller.\+cpp}\end{DoxyCompactItemize}
